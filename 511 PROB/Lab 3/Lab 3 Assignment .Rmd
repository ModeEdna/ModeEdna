---
title: "Lab 3 Assignment"
author: "Dr. Purna Gamage"

output: rmdformats::robobook
---

# Problem 1:

Plot probability density histograms for these discrete distributions (hint: use the d...() function).


a. Binomial Distribution

```{r}
x <- 0:50
plot(x,dbinom(x,size=50,prob=.33),type="h")
```

b. Discrete uniform

```{r}
library("extraDistr")
plot(x,ddunif(x,min=0,max=50), type='h')
```

c. Bernoulli
```{r}
### getting warnings, need to fix
library(Rlab)
plot(x,dbern(x,prob=.7), type='h')
```

d. Poisson
```{r}
plot(x, dpois(x, 20))
```

e. Geometric
```{r}
plot(x, dgeom(x,.25), type = 'h')
```

f. Hypergeometric
```{r}
# successes we want, successes in pop, failures in pop, samples taken
### this code was reused from the lab diary
library(ggplot2)
library(dplyr)
options(scipen = 999, digits = 2) # significant digits

density = dhyper(x = 1:20, m = 70, n = 30, k = 15)

data.frame(red = 1:20, density) %>%
  mutate(red14 = ifelse(red == 14, "x = 14", "other")) %>%
ggplot(aes(x = factor(red), y = density, fill = red14)) +
  geom_col() +
  geom_text(
    aes(label = round(density,2), y = density + 0.01),
    size = 3,
    vjust = 0
  ) +
  labs(x = "Number of red balls (x)", y = "Density")
```

g. Negative binomial
```{r}
plot(x, dnbinom(x,4,.2), type='h')
```

# Problem 2.

Suppose there are fifteen multiple choice questions in ANLY511 midterm test. Each question has four possible answers, and only one of them is correct. Find the probability of having four or less correct answers if a student attempts to answer every question at random.

a. Compute the probability of having exactly 4 correct answers by random attempts using _dbinom()_ and _pbinom()_.
```{r}
# check this one
dbinom(4,15,.25)
# check this one
pbinom(4,15,.25)-pbinom(3,15,.25)
```

b. Find the the probability of having four or less correct answers by random attempts using _dbinom()_.
```{r}
# check this one
sum(dbinom(0:4,15,.25))
```

c. Compute the above probability(part-b) using _pbinom()_.
```{r}
# check this one
pbinom(4,15,.25)
```

# Problem 3:(use r to find the prob)

a. Assume an insurance company receives 3 motor vehicles insurance claims per week. What is the probability that they receive 11 or fewer claims during a month?

$$P(X\le11)?$$
```{r}
# check this one
ppois(11,12)
```

b. While you are at the Georgetown library terrace, you notice that airplanes fly at an average rate of 1 every 4 hours. What is the probability that you will see at least one plane in the next hour?

```{r}
# check this one
ppois(0,.25, lower.tail = FALSE)
```

# Problem 4: Try this example with _..nbinom()_
(This relates to Problem 1 in Lab 1 Assignment) Rolling dice and getting 3 ones.

Mike had the first three successes in trials 6, 8, and 9. He had six failures until he reached three successes.

Do you think Mike has _success probability p = 0.5 or better?_
Can a simulation give an answer?Let's try.

1.  If Mike’s success probability is p = 0.5 What is the probability that he will obtain these 3 successes?. 
```{r}
# exact. check is right
dnbinom(6,3,.5)
```

2. Run many simulations (say 10,000) with this success probability to find the same probability $P(X=6)?$ _Hint: Use rnbinom()_
```{R}
# check to see if right
mean(rnbinom(10000,3,1/2) == 6)
```

3. If Mike’s success probability were 0.5 or better, he would not need a lot of attempts.
Find the probability that three successes were reached after 9 tosses or later by somebody with success probability 0.5. $P(X\ge6)$

a. Calculate the probability using both _dnbinom()_ and _pnbinom()_.
```{r}
# need to check
1-sum(dnbinom(0:5,3,0.5))
pnbinom(5,3,0.5, lower.tail = FALSE)
```

b. Calculate this probability using a Simulation(10,000)
```{r}
# check to see if right
mean(rnbinom(10000,3,0.5) >= 6)
```

c. Is this probability (part b) the same as you got from "myattempts": Lab 1 Assignment Problem 1 part 3?

Not the same, as probabilities used are different (1/6 vs 1/2).




