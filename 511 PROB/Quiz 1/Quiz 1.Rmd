---
title: "Quiz1"
author: "Eduardo Armenta"
date: "2022-09-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Quiz 1

### Problem 1

**1a**. Use capital letters to denote different events in this question.

A: Uses an iphone

B: Uses different phone and not interested in changing

C: Uses different phone and interested in changing

D: Person likes feature

E: Person doesn't like feature

**1b**. Specify all probabilities mentioned in the problem using conditional probability notations and general probability notations.
- P(A) = 355/774, (0.459)

- P(B) = 181/774, (0.234)

- P(C) = 238/774, (0.307)

- P(D) = 500/774, (0.65)

- P(E) = 274/774, (0.35)

- P(D|A) = 0.82

- P(E|A) = 0.18

- P(D|B) = 0.51

- P(E|A) = 0.49

- P(D|C) = 0.49

- P(E|C) =0.51

### Problem 2

**2a**. Write a function (using simulation) that will find probability that if a person liked the feature, then they are currently using an iPhone.

```{r 2}
prob2 <- function(labels, size, probOfLabel, condProbs){
  phone <- sample(labels, size=sims, replace=TRUE,prob=probOfLabel)
  feature <- rep(NA, sims) # create a dummy variable first
  # 0 is disliked, 1 is liked
  feature[phone==labs[1]] <- sample(c(0,1), size=sum(phone==labs[1]), replace=TRUE, prob=condProbs[1:2])
  feature[phone==labs[2]] <- sample(c(0,1), size=sum(phone==labs[2]), replace=TRUE,prob=condProbs[3:4])
  feature[phone==labs[3]] <- sample(c(0,1), size=sum(phone==labs[3]), replace=TRUE,prob=condProbs[5:6])
  return(mean(phone[feature==1]==labs[1]))
}
```

**3a**. Using the function you wrote above, find the probability that if a person liked the feature, then they're using an iphone.

```{r 3}
labs <- c('I','ON', 'OS')
sims <- 100000
probslabel <- c(355/774,181/774,238/774)
condps <- c(c(0.18,0.82), c(0.49,0.51), c(0.51,0.49))

prob2(labs, sims, probslabel, condps)
```

**4a**. Write a function to calculate the probability directly without using a simulation, use that function to compute the probability and compare your answer to part 3.

```{r 4}
reverse <- function(PFI, PI, PF) {
  return ((PFI*(PI))/(PF))
}

PFI <- .82
PI <- (355/774)
PF <- (500/774)

reverse(PFI, PI, PF)
```

*Comparison* : The results were almost identical. Maybe with more simulations we can get close to an exact match.

**5a**. Use Monte Carlo simulation and compare your answer to the probability found in part 4. Here, write a function that can calculate the probability in part 3 for many different number of iterations.

```{r 5}
monteCarlo <- function(s){
  df = data.frame()
  for (k in seq(10,s,1)){
    sims <- k
    output = prob2(labs, sims, probslabel, condps)
    df = rbind(df, output)
  }
  return(df)
}

df <- monteCarlo(10000)
```
