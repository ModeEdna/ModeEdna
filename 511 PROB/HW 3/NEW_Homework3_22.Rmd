---
title: "Homework 3"
author: "Eduardo Armenta"
output:
  html_document: default
  pdf_document: default
---


## Problem 1 (10 Points)

Consider a room that is paved with $n \times n$ square tiles which are labeled from 1 to $n^2$ in some order.  A frog performs a random walk by hopping from one tile to a randomly chosen adjacent tile in each time step.  All adjacent tiles are chosen with the same probability. The frog can never hop into a wall of the room.

__True or not true:__ The transition matrix for this random walk is symmetric, that is, it satisfies $P(X_{i+1} = k| X_i = j) = P(X_{i+1} = j|X_i = k)$ for all $i$ and all possible states  $1 \le j, \, k \le n^2$. Explain your answer.

```{r}
# setting up the matrix
P <- matrix(0, ncol = 9, nrow = 9)
diag(P) <- 0
P[1,2] <- P[1,4] <- 1/2
P[2,1] <- P[2,3] <- P[2,5] <- 1/3
P[3,2] <- P[3,6] <- 1/2
P[4,1] <- P[4,5] <- P[4,7] <- 1/3
P[5,2] <- P[5,4] <- P[5,6] <- P[5,8] <- 1/4
P[6,3] <- P[6,5] <- P[6,9] <- 1/4
P[7,4] <- P[7,8] <- 1/2
P[8,5] <- P[8,7] <- 1/2
P[9,6] <- P[9,8] <- 1/2
P
```
It is not symmetric. If you take the example of this 3x3 matrix, for which the tiles are numbered from left to right, bottom to top, the 1st tile has a probability of 0.5 to go to tile 2, while tile 2 has a probability of 1/3 to go to tile 1. For it to be symmetric, these probabilities would have to be the same.


## Problem 2 (30 Points)

Let $X \sim B(80, .2)$ and $Y \sim B(100, .7)$ be independent binomial random variables. Let $Z = X + Y$ . Find the following conditional quantities, using R simulations:
```{r}
df <- data.frame(x=rbinom(10000, 80, .2), y=rbinom(10000, 100, .7))
df$z <- df$x + df$y
```

a) $P(X < 12|X < 18)$ and $E(X|X < 18)$ (6 points)
```{r}
# probability of x being less than 12 if x is less than 18
length(df$x[df$x<12])/length(df$x[df$x<18])
# expected value
mean(df$x[df$x<18])
```

b) the cumulative distribution function of $X|(12 \le X \le 20)$ (plot of the ecdf) (6 points)
```{r}
plot.ecdf(df$x[df$x<=20 & df$x>=12])
```

c) the cumulative distribution function of $X|Z = 90$ ( plot of the ecdf )(6 points)
```{r}
plot.ecdf(df$x[df$z==90])
```

d) $E(Z|X = k)$ for $k = 10, 15, 20$ . (6 points)
```{r}
mean(df$z[df$x==10 | df$x==15 | df$x==20])
```

e) $E(X|Z = k)$ for $k = 80, 90, 100$ . (6 points)
```{r}
mean(df$x[df$z==80 | df$z==90 | df$z==100])
```


## Problem 3 (20 Points)

Suppose $X$ has an exponential distribution with parameter $\lambda = 1$ and  $Y|X = x$ has a Poisson distribution with parameter $x$. 
```{r}
# creating the dataframe
df <- data.frame(X = round(rexp(100000,1),1))
Ys <- c()
for (x in df$X){
  Ys <- c(Ys, rpois(1,x))
}
df$Y <- Ys

```
a) Generate at least 1000 random samples from the marginal distribution of $X$ and make a probability histogram. (4 Points) 
```{r}
hist(df$X, prob=T)
```

b) Generate at least 1000 random samples from the conditional distribution of $Y|X = 1.5$ and make a probability histogram. (6 Points) 
```{r}
hist(df[df$X==1.5,]$Y, prob=TRUE)
```

c) Generate at least 1000 random samples from the marginal distribution of $Y$ and make a probability histogram. (4 Points) 
```{r}
hist(df$Y, prob=TRUE)
```

d) Generate at least 1000 random samples from the conditional distribution of $X|Y=2$ and make a probability histogram. (6 Points)
```{r}
hist(df[df$Y==2,]$X, prob=TRUE)
```

## Problem 4 (20 Points)

Suppose $X$ and $Y$ have independent standard normal distributions.  Make at least 1,000 random samples from $Z$, defined as $Z = Y|(X + Y \ge 1)$. Do you think that $Z$ has a normal distribution? What are its approximate mean and standard deviation?
```{r}
# generating x, y, z
df <- data.frame(x=rnorm(10000), y=rnorm(10000))
df$z <- df$x+df$y
# getting df where x+y is greater than or equal to 1
Z <- df[df$z>=1,]
# taking sample of Z
sampZ <- sample(Z$y,1000)
# aprox mean
mean(sampZ)
# aprox sd
sd(sampZ)
# histogram
hist(sampZ)
```

Based on the histogram and its mean/sd, the distribution for Z is normal.

## Problem 5 (Submit only *_part 1_* and *_part 4_*; _practice and discuss the parts 2 and 3 with classmates_) (20 Points)

__Mixtures.__ Let $Y_1$ and $Y_2$ be two random variables which have the same range $R$, and let $w_1, w_2$  probabilities with $w_1 + w_2 = 1$. Then the mixture $Y$ of $Y_1$ and $Y_2$ is defined as follows:

*  Select $X \in \{1,2\}$ at random, with $P(X = 1) = w_1, \, P(X = 2) = w_2$.

*  If $X = 1$, draw a sample $Y_1$ and set $Y = Y_1$. Otherwise, draw a sample $Y_2$ and set $Y = Y_2$.

\smallskip 

```{r}
# creating the dataframe
df <- data.frame(Y.1=rnorm(50000,-2,1),Y.2=rnorm(50000,2,sqrt(2)))
df$forMix <- rbinom(50000,1,prob=1/3) +1
df$mixed <- ifelse(df$forMix == 1, df$Y.1, df$Y.2)
```

1. Suppose $E(Y_1) = \mu_1$ and $E(Y_2) = \mu_2$.  What is $E(Y|X = 1)$? What is $E(Y|X=2)$? Use this to show that $E(Y) = w_1 \mu_1 + w_2 \mu_2$. (5 Points)
```{r}
# mean of Y when X is 1 and when X is 2
mean(df[df$forMix==1,]$mixed)
mean(df[df$forMix==2,]$mixed)
# mean of Y using mean() and using the theorem
mean(df$mixed)
mean(df$Y.1)*(2/3)+mean(df$Y.2)*(1/3)
```

2.  Suppose $var(Y_1) = \sigma_1^2$ and $var(Y_2) = \sigma_2^2$.  Explain why $E(Y^2|X = 1) = \sigma_1^2 + \mu_1^2$ and $E(Y^2|X=2) = \sigma_2^2 + \mu_2^2$. Use this to find a formula for $E(Y^2)$. 


3. Use the results of a) and b) to find a formula for $var(Y)$. 

4. Generate a sample of size 10,000 from $Y_1 \sim N(-2,1), \, Y_2 \sim N(2,2), \, w_1 = \frac{1}{3}, \, w_2 = \frac{2}{3}$ and make a probability histogram. Clearly this is not a normal distribution, and a mixture is not a sum! (15 Points)
```{r}
# creating the dataframe
hist(df$mixed)
```


## BONUS

Bobâ€™s preferred bet in American roulette consists in betting $1 on black numbers and simultaneously $2 on even numbers (see the roulette board in the course slides). Find all possible outcomes of a single game and their probabilities, that is, find the probability distribution of the outcome of a single bet. Then compute its expected value.

(Hint: Since the question is asking about a single bet,  you can calculate this by hand)

Possible outcome probs:
Black: 18/38 (would win $2)
Even: 18/38 (would win $4)
Loss: 20/38 (would lose $3)
Black and Even: 10/38 (would win $6)

We must take 10 away from black and even since black and even together has 10 possible outcomes.
Calculate expected winnings on each round: 2*(8/38) + 4*(8/38) + 6*(10/38) = 2.84 are the expected winnings for each round


